<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="icon" type="image/png" sizes="32x32" href="/images/saturn.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/saturn.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"obxygene.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Kernel Polynomial Method (KPM) Kernel polynomial method (KPM) 是一种利用数值 Chebyshev 多项式展开来降低计算复杂度的方法。传统计算谱时常需 \(O(N^3)\) 的对角化方法，而 KPM 则将问题转化为矩阵与一组较小向量的乘法，大幅降低复杂度。同期发展的还有 Lanczos 算法，Lanczos 适合求本征态，KPM">
<meta property="og:type" content="article">
<meta property="og:title" content="Kernel Polynomial Method简介">
<meta property="og:url" content="https://obxygene.github.io/2025/07/14/KPM/index.html">
<meta property="og:site_name" content="obxygene">
<meta property="og:description" content="Kernel Polynomial Method (KPM) Kernel polynomial method (KPM) 是一种利用数值 Chebyshev 多项式展开来降低计算复杂度的方法。传统计算谱时常需 \(O(N^3)\) 的对角化方法，而 KPM 则将问题转化为矩阵与一组较小向量的乘法，大幅降低复杂度。同期发展的还有 Lanczos 算法，Lanczos 适合求本征态，KPM">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-07-13T16:15:48.000Z">
<meta property="article:modified_time" content="2025-07-19T15:13:26.934Z">
<meta property="article:author" content="obxygene">
<meta property="article:tag" content="物理">
<meta property="article:tag" content="杂谈">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://obxygene.github.io/2025/07/14/KPM/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://obxygene.github.io/2025/07/14/KPM/","path":"2025/07/14/KPM/","title":"Kernel Polynomial Method简介"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Kernel Polynomial Method简介 | obxygene</title>
  







<link rel="dns-prefetch" href="https://commentsystem-git-main-obxygenes-projects.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">obxygene</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">以自己的意志，抵达结局吧</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section">首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section">分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section">标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section">归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section">关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#kernel-polynomial-method-kpm"><span class="nav-number">1.</span> <span class="nav-text">Kernel Polynomial Method
(KPM)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B8%8E-gibbs-%E7%8E%B0%E8%B1%A1"><span class="nav-number">1.1.</span> <span class="nav-text">核多项式与 Gibbs 现象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%81%E5%AF%86%E5%BA%A6%E8%AE%A1%E7%AE%97"><span class="nav-number">1.2.</span> <span class="nav-text">态密度计算</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%BA%E9%97%B4%E7%BC%A9%E6%94%BE"><span class="nav-number">1.2.1.</span> <span class="nav-text">区间缩放</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A6%BB%E6%95%A3%E4%BD%99%E5%BC%A6%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2"><span class="nav-number">1.2.2.</span> <span class="nav-text">离散余弦傅里叶变换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A9%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="nav-number">1.2.3.</span> <span class="nav-text">矩的计算</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="obxygene"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">obxygene</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/obxygene" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;obxygene" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:obxygene@gmail.com" title="E-Mail → mailto:obxygene@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://obxygene.github.io/2025/07/14/KPM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="obxygene">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="obxygene">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Kernel Polynomial Method简介 | obxygene">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Kernel Polynomial Method简介
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-07-14 00:15:48" itemprop="dateCreated datePublished" datetime="2025-07-14T00:15:48+08:00">2025-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-19 23:13:26" itemprop="dateModified" datetime="2025-07-19T23:13:26+08:00">2025-07-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%86%99%E4%BD%9C/" itemprop="url" rel="index"><span itemprop="name">写作</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/07/14/KPM/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/07/14/KPM/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>14 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h2 id="kernel-polynomial-method-kpm">Kernel Polynomial Method
(KPM)</h2>
<p>Kernel polynomial method (KPM) 是一种利用数值 Chebyshev
多项式展开来降低计算复杂度的方法。传统计算谱时常需 <span class="math inline">\(O(N^3)\)</span> 的对角化方法，而 KPM
则将问题转化为矩阵与一组较小向量的乘法，大幅降低复杂度。同期发展的还有
Lanczos 算法，Lanczos 适合求本征态，KPM 更适合谱性质和关联函数的计算
<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="Weiße A., Wellein G., Alvermann A., Fehske H., 2006, RvMP, 78, 275. doi:10.1103/RevModPhys.78.275">[1]</span></a></sup>。</p>
<p>KPM 源自函数的正交多项式展开。定义权重函数 <span class="math inline">\(w(x)\)</span> 及区间 <span class="math inline">\([a,b]\)</span> 后，两个可积函数 <span class="math inline">\(f,g:[a,b]\to\mathbb{R}\)</span> 的内积为：</p>
<p><span class="math display">\[
\begin{equation}
\langle f|g \rangle = \int_a^b w(x) f(x) g(x) dx
\end{equation}
\]</span></p>
<p>通过 Schmidt 正交化可得正交多项式 <span class="math inline">\(p_n(x)\)</span>，满足：</p>
<p><span class="math display">\[
\begin{equation}
\langle p_n|p_m \rangle = \delta_{nm}/h_n
\end{equation}
\]</span> 其中 <span class="math inline">\(h_n =
⟨p_n|p_n⟩\)</span>。任意函数可展开为： <span class="math display">\[
\begin{equation}
f(x) = \sum_{n=0}^\infty \alpha_n p_n(x), \quad \alpha_n =
\frac{1}{h_n}\langle p_n|f \rangle
\end{equation}
\]</span>
通常意义上任何正交多项式都可以用来展开函数从而使用KPM，但经过历史和经验的检验，第一类和第二类Chebyshev多项式由于其优秀的收敛性以及与傅里叶变换的相似性而被认为是最佳选择。
### Chebyshev 多项式 Chebyshev 多项式定义在区间 <span class="math inline">\([a,b]=[-1,1]\)</span> 上。第一类 Chebyshev 多项式
<span class="math inline">\(T_n(x)\)</span> 的权重函数为 <span class="math inline">\(w(x)=\frac{1}{\pi\sqrt{1-x^2}}\)</span>，第二类
<span class="math inline">\(U_n(x)\)</span> 的权重函数为 <span class="math inline">\(w(x)=\pi\sqrt{1-x^2}\)</span>。可以验证：</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
T_n(x) &amp;= \cos\left[n \cos^{-1}x\right] \\
U_n(x) &amp;=
\frac{\sin\left[(n+1)\cos^{-1}x\right]}{\sin\left[\cos^{-1}x\right]}
\end{split}
\end{equation}
\]</span></p>
<p>两类 Chebyshev 多项式都存在递推关系。对于第一类：</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
T_0(x) &amp;= 1, \\
T_{-1}(x) &amp;= T_1(x) = x, \\
T_{n+1}(x) &amp;= 2xT_n(x)-T_{n-1}(x)
\end{split}
\end{equation}
\]</span></p>
<p>对于第二类：</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
U_0(x) &amp;= 1, \\
U_{-1}(x) &amp;= 0, \\
U_{n+1}(x) &amp;= 2xU_n(x)-U_{n-1}(x)
\end{split}
\end{equation}
\]</span></p>
<p>此外还有乘积关系：</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
2T_m(x)T_n(x) &amp;= T_{m+n}(x)+T_{m-n}(x), \\
2(x^2-1)U_{m-1}(x)U_{n-1}(x) &amp;= T_{m+n}(x)-T_{m-n}(x)
\end{split}
\end{equation}
\]</span></p>
<p>两种权重函数分别给出两种内积定义：</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
    \langle f|g \rangle_1 &amp;= \int_{-1}^{1}
\frac{f(x)g(x)}{\pi\sqrt{1-x^2}} dx, \\
    \langle f|g \rangle_2 &amp;= \int_{-1}^{1} \pi\sqrt{1-x^2} f(x)g(x)
dx
\end{split}
\end{equation}\]</span></p>
<p>对应的正交性关系为：</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
    \langle T_n|T_m \rangle_1 &amp;=
\frac{1+\delta_{n,0}}{2}\delta_{n,m} \\
    \langle U_n|U_m \rangle_2 &amp;= \frac{\pi^2}{2}\delta_{n,m}
\end{split}
\end{equation}\]</span></p>
<p>定义 <span class="math inline">\(\phi_n(x)=\frac{T_n(x)}{\pi\sqrt{1-x^2}}\)</span>，则在第二种内积下有：</p>
<p><span class="math display">\[\begin{equation}
\langle \phi_n|\phi_m \rangle_2 = \frac{1+\delta_{n,0}}{2}\delta_{nm}
\end{equation}\]</span></p>
<p>可以验证任意函数都可以展开为：</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
    f(x) &amp;= \sum_{n=0}^{\infty} \frac{\langle f|\phi_n
\rangle_2}{\langle \phi_n|\phi_n \rangle_2} \phi_n(x) \\
    &amp;= \frac{1}{\pi\sqrt{1-x^2}}\left(\mu_0 + 2\sum_{n=1}^{\infty}
\mu_n T_n(x)\right)
\end{split}
\end{equation}\]</span></p>
<p>其中系数<span class="math inline">\(\mu_n\)</span>叫做矩，定义为：</p>
<p><span class="math display">\[\begin{equation}
\mu_n = \langle f|\phi_n \rangle_2 = \int_{-1}^{1} f(x) T_n(x) dx
\end{equation}\]</span></p>
<hr>
<h3 id="核多项式与-gibbs-现象">核多项式与 Gibbs 现象</h3>
<p>实际计算中通常需要截断展开，直接截断会导致严重的 Gibbs
现象。为此常引入阻尼 kernel 系数 <span class="math inline">\(\mu_n \to
g_n \mu_n\)</span> 修正展开系数：</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
    f(x) &amp;= \frac{1}{\pi\sqrt{1-x^2}}\left(\mu_0 +
2\sum_{n=1}^{\infty} \mu_n T_n(x)\right) \\
    &amp;\to \frac{1}{\pi\sqrt{1-x^2}}\left(\mu_0 g_0 +
2\sum_{n=1}^{N-1} \mu_n g_n T_n(x)\right)
\end{split}
\end{equation}\]</span></p>
<p>常用的 Jackson 核为：</p>
<p><span class="math display">\[\begin{equation}
g_n^{\text{J}} = \frac{1}{N+1}\left[(N-n+1)\cos\frac{\pi n}{N+1} +
\sin\frac{\pi n}{N+1}\cot\frac{\pi}{N+1}\right]
\end{equation}\]</span></p>
<p>格林函数计算中常用 Lorentz 核：</p>
<p><span class="math display">\[\begin{equation}
g_n^L = \frac{\sinh\left[\lambda\left(1-\frac{n}{N}\right)\right]}{\sinh
\lambda}
\end{equation}\]</span></p>
<p>其中参数 <span class="math inline">\(\lambda \in
\mathbb{R}\)</span>，通常取 <span class="math inline">\(3\sim5\)</span>。</p>
<hr>
<h3 id="态密度计算">态密度计算</h3>
<h4 id="区间缩放">区间缩放</h4>
<p>Chebyshev 展开定义在 <span class="math inline">\([-1,1]\)</span>，对于矩阵运算需保证本征值 <span class="math inline">\(\{E_k\}\)</span> 也在 <span class="math inline">\([-1,1]\)</span>。可作线性变换：</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\tilde{H} &amp;= \frac{H-b}{a} \\
\tilde{E} &amp;= \frac{E-b}{a}
\end{split}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(a, b\)</span>
由哈密顿量最大最小本征值 <span class="math inline">\(E_{\text{max}},
E_{\text{min}}\)</span> 决定：</p>
<p><span class="math display">\[\begin{equation}
a = \frac{E_{\text{max}}-E_{\text{min}}}{2-\epsilon} \\
b = \frac{E_{\text{max}}+E_{\text{min}}}{2}
\end{equation}\]</span></p>
<p>参数<span class="math inline">\(\epsilon\)</span>
用于避免谱边界刚好处于或超过 <span class="math inline">\([-1,1]\)</span>，通常取 <span class="math inline">\(0.01\)</span>。</p>
<p>最大最小本征值可用 Lanczos 算法（如 Matlab 的 eigs）获得：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">E_max = eigs(H_sparse, <span class="number">1</span>, <span class="string">&#x27;largestreal&#x27;</span>)</span><br><span class="line">E_min = eigs(H_sparse, <span class="number">1</span>, <span class="string">&#x27;smallestreal&#x27;</span>)</span><br><span class="line">a = (E_max - E_min)/(<span class="number">2</span> - epsilon);</span><br><span class="line">b = (E_max + E_min)/<span class="number">2</span>;</span><br><span class="line">H_tilde = sparse((H_sparse - b)/a);</span><br></pre></td></tr></table></figure>
<h4 id="离散余弦傅里叶变换">离散余弦傅里叶变换</h4>
<p>在对函数 <span class="math inline">\(f(x)\)</span>
展开作截断并利用核多项式修正后，对于给定点 <span class="math inline">\(x\)</span>，有如下展开式：</p>
<p><span class="math display">\[
\begin{equation}
f(x) = \frac{1}{\pi\sqrt{1-x^2}}\left(\mu_0 g_0 + 2\sum_{n=1}^{N-1}
\mu_n g_n T_n(x)\right)
\end{equation}
\]</span></p>
<p>利用 Chebyshev
多项式的性质，还可以进一步减少计算时间。定义核多项式修正后的矩系数为</p>
<p><span class="math display">\[
\begin{equation}
\tilde{\mu}_n = \mu_n g_n
\end{equation}
\]</span></p>
<p>此时展开式可以写为</p>
<p><span class="math display">\[
\begin{equation}
f(x) = \frac{1}{\pi\sqrt{1-x^2}}\left(\tilde{\mu}_0 + 2\sum_{n=1}^{N-1}
\tilde{\mu}_n T_n(x)\right)
\end{equation}
\]</span></p>
<p>如果采样点 <span class="math inline">\(x\)</span> 取为特殊的 <span class="math inline">\(x_k\)</span>，满足</p>
<p><span class="math display">\[
\begin{equation}
x_k = \cos\frac{\pi(k+1/2)}{\tilde{N}},\quad k=0,\ldots,(\tilde{N}-1)
\end{equation}
\]</span></p>
<p>则有</p>
<p><span class="math display">\[
\begin{equation}
T_n(x_k) = \cos\left[n\cos^{-1}x_k\right] =
\cos\left[\frac{n\pi(k+1/2)}{\tilde{N}}\right]
\end{equation}
\]</span></p>
<p>这些点被称为 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Chebyshev_nodes">Chebyshev 节点</a>
<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="尽管matlab中内置有Chebyshev多项式`chebyshevT`,但实际上直接利用cos去定义Chebyshev多项式时，其速度远快于调用`chebyshevT`">[2]</span></a></sup>。<span class="math inline">\(\tilde{N}\)</span> 通常取 <span class="math inline">\(2N\)</span>。在这些点上，<span class="math inline">\(f(x_k)\)</span> 可以通过对 <span class="math inline">\(\tilde{\mu}_n\)</span>
作第三类离散余弦变换（DCT-III）得到：</p>
<p><span class="math display">\[
\begin{equation}
y[k] = \frac{1}{2}x_0 + \sum_{n=1}^{N-1} x_n
\cos\left[\frac{n\pi(k+1/2)}{N}\right]
\end{equation}
\]</span></p>
<p>由于第三类余弦变换可以利用快速傅里叶变换（FFT）加速，因此比直接乘积更快。Matlab
示例代码：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">omega_dct = <span class="built_in">cos</span>(<span class="built_in">pi</span> * ((<span class="number">0</span>:N_points<span class="number">-1</span>)+<span class="number">0.5</span>)/N_points);</span><br><span class="line">Moments_Kernel(<span class="number">1</span>) = Moments_Kernel(<span class="number">1</span>)/<span class="built_in">sqrt</span>(<span class="number">2</span>);</span><br><span class="line">DOS = dct(Moments_Kernel,N_points,<span class="string">&#x27;Type&#x27;</span>, <span class="number">3</span>) .*(<span class="built_in">pi</span> * <span class="built_in">sqrt</span>(<span class="number">1</span> - omega_dct.^<span class="number">2</span>));</span><br></pre></td></tr></table></figure>
<div style="border-left: 4px solid #ff0000ff; background: #d7e9f6ff; padding: 10px; margin: 10px 0;">
<p>注意：第二行对矩的第一个元素除以了 <span class="math inline">\(\sqrt{2}\)</span>，这是由于 Matlab 的 dct
定义与上述第三类余弦变换的系数在第一项与剩余项之间相差一个 <span class="math inline">\(\sqrt{2}\)</span>，若不修改，会导致余弦变换的系数收敛到零的速度变慢，给出错误的态密度。</p>
</div>
<h4 id="矩的计算">矩的计算</h4>
<p>KPM 展开可以被应用到算符上，例如哈密顿量 <span class="math inline">\(\hat{H}\)</span>。在利用 KPM
计算时需要关注两种形式的矩：</p>
<p>其一是两个态的期望： <span class="math display">\[ \begin{equation}
\mu_n = \langle \beta | T_n(\tilde{H}) | \alpha \rangle \end{equation}
\]</span></p>
<p>其二为算符 <span class="math inline">\(\hat{A}\)</span>
与多项式的迹： <span class="math display">\[ \begin{equation} \mu_n =
\mathrm{Tr}[A T_n(\tilde{H})] \end{equation} \]</span></p>
<p>对于第一种情况，可以利用迭代关系直接计算。令 <span class="math inline">\(|\alpha_n\rangle =
T_n(H)|\alpha\rangle\)</span>，有</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
|\alpha_0\rangle &amp;= |\alpha\rangle \\
|\alpha_1\rangle &amp;= \tilde{H}|\alpha_0\rangle \\
|\alpha_{n+1}\rangle &amp;= 2\tilde{H}|\alpha_n\rangle -
|\alpha_{n-1}\rangle
\end{split}
\end{equation}
\]</span></p>
<p>随即可算出矩 <span class="math inline">\(\mu_n = \langle \beta |
\alpha_n
\rangle\)</span>。整个过程只涉及到矩阵乘法，且可以利用稀疏矩阵方法提升大尺寸运算效率。如果
<span class="math inline">\(|\beta\rangle =
|\alpha\rangle\)</span>，还可以进一步简化。利用乘积关系可验证，对于偶数次矩有</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
2\langle \alpha_n | \alpha_n \rangle - \mu_0 &amp;= 2\langle \alpha |
T_n(\tilde{H})^\dagger T_n(\tilde{H}) | \alpha \rangle - \mu_0 \\
&amp;= 2\langle \alpha | T_n(\tilde{H}) T_n(\tilde{H}) | \alpha \rangle
- \mu_0 \\
&amp;= \langle \alpha | \left(T_0(\tilde{H}) + T_{2n}(\tilde{H})\right)
| \alpha \rangle - \mu_0 \\
&amp;= \langle \alpha | \alpha_0 \rangle + \langle \alpha | \alpha_{2n}
\rangle - \mu_0 \\
&amp;= \mu_{2n}
\end{split}
\end{equation}
\]</span></p>
<p>奇数次矩有</p>
<p><span class="math display">\[
\begin{equation}
\begin{split}
2\langle \alpha_{n+1} | \alpha_n \rangle - \mu_1 &amp;= 2\langle \alpha
| T_{n+1}(\tilde{H})^\dagger T_n(\tilde{H}) | \alpha \rangle - \mu_1 \\
&amp;= 2\langle \alpha | T_{n+1}(\tilde{H}) T_n(\tilde{H}) | \alpha
\rangle - \mu_1 \\
&amp;= \langle \alpha | \left(T_1(\tilde{H}) +
T_{2n+1}(\tilde{H})\right) | \alpha \rangle - \mu_1 \\
&amp;= \langle \alpha | \alpha_1 \rangle + \langle \alpha |
\alpha_{2n+1} \rangle - \mu_1 \\
&amp;= \mu_{2n+1}
\end{split}
\end{equation} \]</span></p>
<p>因此当 <span class="math inline">\(|\alpha\rangle =
|\beta\rangle\)</span> 时，可将矩的计算减半：</p>
<p><span class="math display">\[ \begin{equation} \begin{split} \mu_{2n}
&amp;= 2\langle \alpha_n | \alpha_n \rangle - \mu_0 \\
\mu_{2n+1} &amp;= 2\langle \alpha_{n+1} | \alpha_n \rangle - \mu_1
\end{split} \end{equation} \]</span></p>
<p>对于第二种情况，以态密度为例。假设本征态 <span class="math inline">\(\tilde{H}|k\rangle =
E_k|k\rangle\)</span>，态密度定义为</p>
<p><span class="math display">\[ \begin{equation} \rho(E) = \sum_k
\delta(E-E_k) = \mathrm{Tr}\left[\delta(E-\tilde{H})\right]
\end{equation} \]</span></p>
<p><span class="math inline">\(\delta\)</span> 函数可用 Chebyshev
多项式展开为矩：</p>
<p><span class="math display">\[ \begin{equation} \begin{split} \mu_n
&amp;= \int_{-1}^{1} \rho(E) T_n(E) dE \\ &amp;= \int_{-1}^{1} \sum_k
\delta(E-E_k) T_n(E) dE \\ &amp;= \sum_k T_n(E_k) \end{split}
\end{equation} \]</span></p>
<p>利用 <span class="math inline">\(T_n(H)|k\rangle =
T_n(E_k)|k\rangle\)</span>，可得</p>
<p><span class="math display">\[ \begin{equation} \mu_n = \sum_k \langle
k | T_n(H) | k \rangle = \mathrm{Tr}[T_n(H)] \end{equation}
\]</span></p>
<p>由于 Chebyshev 多项式存在递推关系，有</p>
<p><span class="math display">\[
\begin{equation} \begin{split} |\alpha_n(k)\rangle &amp;=
T_n(H)|k\rangle \\ |\alpha_{n+1}(k)\rangle &amp;= 2H|\alpha_n(k)\rangle
- |\alpha_{n-1}(k)\rangle \end{split} \end{equation} \]</span></p>
<p>此时矩变为</p>
<p><span class="math display">\[ \begin{equation} \mu_n = \sum_k \langle
\alpha_0(k) | \alpha_n(k) \rangle = \sum_k \langle k | T_n(H) | k
\rangle \end{equation} \]</span></p>
<p>注意到之前公式中我们可以将态密度转换为了展开系数的计算，而上式表明，展开系数的计算只需要计算两个向量的内积，又因为<span class="math inline">\(|\alpha_n(k)\rangle\)</span>各阶项实际上是一个矩阵乘法运算，通过上述的步骤，我们可以跳过高复杂度的对角化方法，仅通过矩阵乘法就可以得到态密度的展开系数。</p>
<p>实际上，计算迹时并不需要对所有本征态求和，只需对少量随机归一化向量
<span class="math inline">\(|r\rangle\)</span> 取平均即可获得对 <span class="math inline">\(\mu_n\)</span> 的良好估计：</p>
<p><span class="math display">\[ \begin{equation} \mu_n = \mathrm{Tr}[A
T_n(H)] \approx \frac{1}{R} \sum_{r=1}^R \langle r | A T_n(H) | r
\rangle \end{equation} \]</span></p>
<p>其中 <span class="math inline">\(|r\rangle = \frac{1}{\sqrt{D}}
\sum_{i=1}^D \xi_{rk} |k\rangle\)</span>，<span class="math inline">\(\xi_{rk}\)</span> 为复随机的归一化向量，满足</p>
<p><span class="math display">\[ \begin{equation} \begin{split}
\mathbb{E}[\xi_{rk}] &amp;= 0 \\ \mathbb{E}[\xi_{rk}\xi_{r&#39;l}]
&amp;= 0 \\ \mathbb{E}[\xi^*_{rk}\xi_{r&#39;l}] &amp;=
\delta_{rr&#39;}\delta_{kl} \end{split} \end{equation} \]</span></p>
<p>若 <span class="math inline">\(\xi_{rk}=e^{i\phi}\)</span>，<span class="math inline">\(\phi\in[0,2\pi]\)</span>
满足均匀或高斯分布，可以获得相当精确的结果。</p>
<div id="footnotes">
<hr>
<div id="footnotelist">
<ol style="list-style: none; padding-left: 0; margin-left: 40px">
<li id="fn:1">
<span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">Weiße
A., Wellein G., Alvermann A., Fehske H., 2006, RvMP, 78, 275.
doi:10.1103/RevModPhys.78.275<a href="#fnref:1" rev="footnote">
↩︎</a></span>
</li>
<li id="fn:2">
<span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">尽管matlab中内置有Chebyshev多项式<code>chebyshevT</code>,但实际上直接利用cos去定义Chebyshev多项式时，其速度远快于调用<code>chebyshevT</code><a href="#fnref:2" rev="footnote">
↩︎</a></span>
</li>
</ol>
</div>
</div>


    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>obxygene
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://obxygene.github.io/2025/07/14/KPM/" title="Kernel Polynomial Method简介">https://obxygene.github.io/2025/07/14/KPM/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E7%89%A9%E7%90%86/" rel="tag"># 物理</a>
              <a href="/tags/%E6%9D%82%E8%B0%88/" rel="tag"># 杂谈</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/04/%E6%9D%82%E8%B0%88-%E4%BB%80%E4%B9%88%E6%98%AF%E7%89%A9%E7%90%86%E5%9B%BE%E5%83%8F%EF%BC%9F/" rel="prev" title="杂谈-什么是物理图像？">
                  <i class="fa fa-angle-left"></i> 杂谈-什么是物理图像？
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/07/20/BoseHubbard/" rel="next" title="精确对角化-以Bose Hubbard模型为例">
                  精确对角化-以Bose Hubbard模型为例 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">obxygene</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">45k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">1:15</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>


<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>
-->



<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("03/21/2025 00:50:53"); //此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "Online "+dnum+" Days ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒.";
    }
setInterval("createtime()",250);
</script>
    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.0/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>




  <script src="/js/third-party/pace.js"></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://commentsystem-git-main-obxygenes-projects.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"请文明评论呀~","avatar":"/images/avatar.gif","meta":["nick","mail"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":["nick"],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2025/07/14/KPM/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

</body>
</html>
